---
title: "R Notebook"
output:
  html_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

<a href = "#outid">Last plot</a>

```{r, echo=FALSE, results = 'asis', message=FALSE, warning=FALSE}
library(data.table)
library(htmlTable)
library(knitr)
library(xtable)

setwd("C:/Users/cmcneil/Documents/Projects/Miscellaneous/Personal")

# Include useful functions
source("General Code/UsefulFunctions.R")
source("General Code/MarkdownFunctions.R")

# Include functions for creating maps.
source("d3/googleMaps.R")

# Initialize functions and options, requies name of file as parameter.
markdown_init("testfile.RMD", echo = T)
```
[figure](#three)
```{r, echo=FALSE, results='asis', warning=FALSE}
lst <- list(stations = list(svg = c(position = "absolute", color = "red"),
                          svg = c(width = "60px", height = "60px", "padding-bottom" = "100px", 
                                  "padding-right" = "100px", font = "12px sans-serif"),
                          circle = c(fill = "red", stroke = "black", "stroke-width" = "1px", "-webkit-animation-name" = "redPulse", 
                                   "-webkit-animation-duration" = "2s", "-webkit-animation-iteration-count" = "infinite"), 
                          "circle:hover" = c(fill = "blue", cursor = "pointer")), 
            marker_text = c(fill = "black", visibility = "hidden"))

cat(cgm_init())
cat(cgm_styles(lst))
#objects <- list(data = list(London = list(-0.1198244, 51.5112139, "Capital of Great Britain"), WashingtonDC = list(-77.0364641, 38.9072309, "Capital of United States")))

# This currently isn't doing anything
funs <- list(expandNode = '() {d3.select(this).transition().duration(1000).attr("r", 7)}', 
             contractNode = '() {d3.select(this).transition().duration(100).attr("r", 4)}')

# Get data for plotting
dat1 <- data.table(lon = c(-0.1198244, -77.0364641), lat = c(51.5112139, 38.9072309), city = c("London", "WashingtonDC"), description = c("Capital of Great Britain", "Capital of United States"))
data(world.cities, package = "maps")
dat2 <- data.table(world.cities) # [, Scale: = (1:10)*2]

# Set some random values to be used for plotting characteristics
dat2$Scale  <- c(1, 1, 2)*8
dat2$Stroke <- (1:5)*2
dat2$Stroke <- (1:10)

# Create objects (similar to ggplot syntax: using map instead of aes, using add_point instead of geom_point)
objects1 <- add_point(dat1, map(lon = lon, lat = lat, fill = "blue", col = "seagreen", stroke = 2))
objects2 <- add_point(dat2[country.etc == "USA"][1:300],
                      map(lon = long, lat = lat, fill = pop, size = Scale, group = letters[Stroke], col = "red", alpha = .6),
                      opts = list(fill_log = T))
#objects2 <- add_point(dat2[10100:10110],map(lon = long,lat = lat,fill = "green"))

cat(cgm_js(objects2,jsFUNs = funs))


```


```{r,echo = FALSE,results = 'asis'}
cat("<div id='map_canvas' style=\"height: 600px;\"></div>")
```

```{r plots, caption = paste("plot", 1:3), out.extra = paste0('id="plots', 1:3, '"')}
plot(cars)
plot(1:10)
plot(rnorm(1e3))
```

```{r, results='asis'}

dt <- data.table(x = 1:10, f = factor(letters[1:10]), c = letters[11:20], f2 = factor(letters[1:10]), c2 = letters[11:20])
ht <- htmlTable(dt, 
                align = c("l|rc|rc"), align.cgroup = c("cc", "rcl"), 
                rgroup = c("one", "two"), n.rgroup = c(6, 4), 
                col.rgroup = c("white", "lightyellow", "gray90", "gray90"), 
                cgroup = rbind(c("", "Values", NA), c("First", "Second", "Third")), 
                n.cgroup = rbind(c(1, 2, NA), c(1,2,2)), tfoot="&dagger; A table footer commment", 
                cspan.rgroup = 2,
                css.table = "margin-top: 1em; margin-bottom: 1em; margin-left: auto; margin-right: auto; padding: 3em; font-size: 18px", 
                css.cell = "padding-left: 3em; padding-right: 3em", 
                rnames = F, label = "htmltab1", caption = "This is a table", header = c(letters[1:5]))
href1 <- htmlref("htmltab1")
href2 <- htmlref("htmltab2", 1)
print(ht, useViewer = F)

```

This a reference to `r href1`. Here is a reference to the next table, `r href2`. 
Reference to `r htmlref("four")`.


```{r, results='asis'}

dt <- data.table(x = 1:10, f = factor(letters[1:10]), c = letters[11:20])
ht <- htmlTable(dt, 
                align = c("l|rc|"), align.cgroup = "c", 
                col.rgroup = c("white", "white", "gray90", "gray90"), 
                cgroup = c("First", "Second"), n.cgroup = 1:2, tfoot="&dagger; A table footer commment", 
                #css.table = "margin-top: 1em; margin-bottom: 1em; margin-left: auto; margin-right: auto;", 
                rnames = F, label = "htmltab2", caption = "This is a table")
print(ht, useViewer = F)
```

`r paste(names(opts_current$get()), collapse = ", ")`

```{r three, fig.align = 'center'}
plot(1:20)
```

```{r four}
plot(rnorm(20))
```

