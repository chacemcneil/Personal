source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(1))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/general code/UsefulFUnctions.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
objects$data
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
objects$data
is.null(objects$data)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
cat(cgm_js(objects))
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
cat(cgm_js(objects))
bounds <- cgm_findbounds(objects)
bounds
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
cat(cgm_js(objects))
cgm_js(objects)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
objects <- list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States"))
objects <- list(objects)
objects[[1]]
toJSON(objects[[1]])
toJSON(list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States")))
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
cat(cgm_js(objects))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R",v=T)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
dir()
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/general code/UsefulFUnctions.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
dat <- data.table(lon=c(-0.1198244,-77.0364641),lat=c(51.5112139,38.9072309),city=c("London","WashingtonDC"),description=c("Capital of Great Britain","Capital of United States"))
objects <- add_point(dat,map(lon,lat))
objects
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
funs <- list(expandNode='() {d3.select(this).transition().duration(1000).attr("r",7)}',
contractNode='() {d3.select(this).transition().duration(100).attr("r",4)}')
dat <- data.table(lon=c(-0.1198244,-77.0364641),lat=c(51.5112139,38.9072309),city=c("London","WashingtonDC"),description=c("Capital of Great Britain","Capital of United States"))
objects <- add_point(dat,map(lon,lat))
objects
cat(cgm_js(objects,jsFUNs=funs))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- add_point(dat,map(lon,lat))
objects <- add_point(dat,map(lon,lat))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
funs <- list(expandNode='() {d3.select(this).transition().duration(1000).attr("r",7)}',
contractNode='() {d3.select(this).transition().duration(100).attr("r",4)}')
dat <- data.table(lon=c(-0.1198244,-77.0364641),lat=c(51.5112139,38.9072309),city=c("London","WashingtonDC"),description=c("Capital of Great Britain","Capital of United States"))
objects <- add_point(dat,map(lon,lat))
objects
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
dat <- data.table(lon=c(-0.1198244,-77.0364641),lat=c(51.5112139,38.9072309),city=c("London","WashingtonDC"),description=c("Capital of Great Britain","Capital of United States"))
objects <- add_point(dat,map(lon,lat))
objects
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
rm(add_point)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
objects <- list(data=list(London=list(-0.1198244,51.5112139,"Capital of Great Britain"),WashingtonDC=list(-77.0364641,38.9072309,"Capital of United States")))
toJSON(objects)
toJSON(objects$data)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
funs <- list(expandNode='() {d3.select(this).transition().duration(1000).attr("r",7)}',
contractNode='() {d3.select(this).transition().duration(100).attr("r",4)}')
dat <- data.table(lon=c(-0.1198244,-77.0364641),lat=c(51.5112139,38.9072309),city=c("London","WashingtonDC"),description=c("Capital of Great Britain","Capital of United States"))
objects <- add_point(dat,map(lon,lat))
objects
objects = list(objects)
objects
seq_along(objects)
i=1
objects[[i]]$json
cat(lv)
paste('var projection = this.getProjection(), padding = 10; console.log(',objects[[i]]$json,');\n',
'var marker',i,' = layer.selectAll("svg").data(d3.entries(',objects[[i]]$json,')).each(transform).enter().append("svg:svg").each(transform).attr("class", "marker");\n',
'marker',i,objects[[i]]$d3js,';\n\n',
'//.on("mouseout",contractNode);\n\n',
'marker',i,'.append("svg:text").attr("x", padding + 7).attr("y", padding).attr("dy", ".31em").attr("class","marker_text").text(function(d) {return d.key; });\n\n'
,sep="")
map(long,lat,fill="green")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
map(long,lat,fill="green")
map
map(long,lat,fill="green")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
map(long,lat,fill="green")
detach("package:maps")
map
map(long,lat,fill="green")
map(lon=long,lat,fill="green")
map(lon=long,lat=lat,fill="green")
map(long,lat)
map
map(lon,lat)
cat(.lv)
source("r:/users/cmcneil/projects/miscellaneous/personal/general code/UsefulFUnctions.R")
cat(lv)
map(lon,lat)
cat(lv)
map(lon,lat,fill="green")
class(lv)
print.uneval
cat(map(lon,lat,fill="green"))
print(map(lon,lat,fill="green"))
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green"))
dat2 <- data.table(world.cities)
dat2 <- data.table(maps::world.cities)
dat2 <- data.table(maps:world.cities)
dat2 <- data.table(data(world.cities))
dat2 <- data.table(data(maps::world.cities))
dat2 <- data.table(data(maps:world.cities))
data("maps::world.cities")
data("maps:world.cities")
library(maps)
dat2 <- data(world.cities)
dim(dat2)
class(dat2)
dat2
dat2 <- data.table(world.cities)
dim(dat2)
detach("package:maps")
dim(dat2)
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green"))
data
map
head(world.cities)
detach("package:maps")
add_point(dat2[1:20],map(lon=long,lat=lat,fill="green"))
dat2[1:10]
objects2 <- add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",scale=pop))
scale
scale(1:10,5)
linear
dat2[1:10][,Scale:=(1:10)*2]
print(lv)
add_point(dat2[1:10][,Scale:=(1:10)*2],map(lon=long,lat=lat,fill="green",scale=Scale))
mp <- map(lon=long,lat=lat,fill="green",scale=Scale)
mapping <- mp
mapping[pointkey[! R %in% names(mapping),R]] <- pointkey[! R %in% names(mapping),Default]
mapping <- mapping[match(pointkey$R,names(map))]
names(mapping) <- pointkey$SVG
mapping
mp
mapping <- mp
pointkey
mapping[pointkey[! R %in% names(mapping),R]] <- pointkey[! R %in% names(mapping),Default]
mapping
mapping[match(pointkey$R,names(map))]
mapping[match(pointkey$R,names(maping))]
mapping[match(pointkey$R,names(mapping))]
add_point(dat2[1:10][,Scale:=(1:10)*2],map(lon=long,lat=lat,fill="green",size=Scale))
dat2[1:10][,Scale:=(1:10)*2]
dat2 <- data.table(world.cities)[,Scale:=(1:10)*2]
dat2
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale)))
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
dat2
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
dat2[1:10]
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
cat(add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))$json)
mapping
names(mapping)
this <- 1:26
names(this) <- letters
sapply(this,names)
sapply(this,function(x) print(names(x)))
mappin[2]
mapping[2]
mapping
mapping[2]
eval(mapping[2])
eval(mapping[2],envir=dat2)
dat2
eval(mapping[2],envir=dat2)
class(mappin)
class(mapping)
class(mapping[2])
eval(mapping[2])
eval
lapply(mapping,eval,envir=dat2)
mapping
mapping[[2]]
eval(lv)
min(c(1,2,3,NA))
range(c(1,2,3,NA))
is.finite(NA)
is.finite(Inf)
is.finite(-Inf)
is.finite(NaN)
NaN
is.finite(4e322)
is.finite(4e312)
is.finite(4e212)
is.finite(NA)
library(ggplot2)
dat2
ggplot(dat2[1:10],aes(lon,lat,size=name)) + geom_point()
ggplot(dat2[1:10],aes(long,lat,size=name)) + geom_point()
col2hex
coltohex
library(RColorBrewer)
col2hex
??col
hex("red")
colorspace::hex("red")
library(gplots)
col2hex("red")
mean(lv)
as.numeric(col2hex("red"))
rainbow(4)
plot(1:4,col=rainbow(4))
plot(1:4,col=rainbow(4),pch=19)
plot(1:4,col=rainbow(40),pch=19)
uniue(rainbow(40))
unique(rainbow(40))
length(lv)
plot(1:40,col=rainbow(40),pch=19)
rainbow
darken
darker
library(munsell)
darker("red")
darker(col2hex("red"))
??dark
col2hex("darkred")
col2hex("lightred")
col2hex("pink")
col2hex("lightblue")
col2hex("blue")
plot(1,pch=19,cex=10,col="#0000FF")
plot(1,pch=19,cex=10,col="#1111FF")
plot(1,pch=19,cex=10,col="#5555FF")
plot(1,pch=19,cex=10,col="#7777FF")
plot(1,pch=19,cex=10,col="#8888FF")
col2rgb("red")
col2rgb("#FF0000")
col2rgb("#FF1300")
col2rgb("#AA0000")
plot(1,pch=19,cex=10,col="#0000AA")
plot(1,pch=19,cex=10,col="#000055")
col2rgb
rgb2col
col2hex
rgb2hex
col2rgb
?col2rgb
rgb(1,3,5)
rgb(1:3)
rgb(1,3,5,1)
rgb(1,.5,.5,1)
plot(1,pch=19,cex=10,col=rgb(1,.5,.5,1))
plot(1,pch=19,cex=10,col=rgb(1,.5,.5,.1))
plot(1,pch=19,cex=10,col=rgb(1,.5,.5,.9))
plot(1,pch=19,cex=10,col=rgb(1,.5,.5,.5))
plot(1,pch=19,cex=10,col=rgb(.5,.25,.25))
plot(1,pch=19,cex=10,col=rgb(1,.75,.75,.5))
plot(1,pch=19,cex=10,col=rgb(1,.75,.75,1))
plot(1,pch=19,cex=10,col=rgb(1,.5,.5,.5))
col2rgb("blue")
rgb2col
rgb
col2rgb(c("red","blue"))
col2rgb(c("red","blue"))["red",]
darken <- function(col,factor=1/4) {
rgb <- col2rgb(col)
rgb <- round(rgb*factor)
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
darken("red")
col2rgb("red")
col2rgb("red")["red",]
rgb
darken <- function(col,factor=1/4) {
rgb <- round(col2rgb(col)*factor/255)
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
darken("red")
col="red"
rgb <- round(col2rgb(col)*factor/255)
rgb
factor=.75
rgb <- round(col2rgb(col)*factor/255)
rgb
darken <- function(col,factor=1/4) {
rgb <- (col2rgb(col)*factor/255)
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
darken("red")
plot(1,pch=19,cex=10,col="red")
plot(1,pch=19,cex=10,col=darken("red"))
darken <- function(col,factor=1/4) {
rgb <- (col2rgb(col)*(1-factor)/255)
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
plot(1,pch=19,cex=10,col=darken("red"))
plot(1,pch=19,cex=10,col=("red"))
plot(1,pch=19,cex=10,col=("blue"))
plot(1,pch=19,cex=10,col=darken("blue"))
darken <- function(col,factor=1/3) {
rgb <- col2rgb(col)*(1-factor)/255
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
plot(1,pch=19,cex=10,col=("blue"))
plot(1,pch=19,cex=10,col=darken("blue"))
lighten <- function(col,factor=1/3) {
rgb <- 1- (1-col2rgb(col)/255)*(1-factor)
newcol <- rgb(red=rgb["red",],green=rgb["green",],blue=rgb["blue",],alpha=1)
newcol
}
plot(1,pch=19,cex=10,col=("blue"))
plot(1,pch=19,cex=10,col=lighten("blue"))
plot(1,pch=19,cex=10,col=lighten(lighten("blue")))
plot(1,pch=19,cex=10,col=lighten(lighten(lighten("blue"))))
plot(1,pch=19,cex=10,col=lighten(lighten(lighten(lighten("blue")))))
plot(1,pch=19,cex=10,col=lighten(lighten(darken(darken("blue")))))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
function
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
dat2[1:10]
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
dat2 <- data.table(world.cities)[,Scale:=(1:10)*2+4]
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
add_point(dat,map(lon,lat))
dat2[1:10]
detach("package:gplots")
dat2 <- data.table(world.cities) # [,Scale:=(1:10)*2]
dat2$Scale <- (1:10)*2
dat2$Scale <- (1:5)*4
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
source("r:/users/cmcneil/projects/miscellaneous/personal/general code/UsefulFUnctions.R")
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps2.R")
add_point(dat2[1:10],map(lon=long,lat=lat,fill="green",size=Scale))
dat[100:110]
dat2[100:110]
dat2[1100:1110]
dat2[10100:10110]
r2html
r2html <- data.table(R=c("col","fill","stroke","size","group","lon","lat"),SVG=c("stroke","fill","stroke-width","r","symbol","lon","lat"),Default=c("black","red",2,5,"circle",NA,NA),Call=c("style","style","style","attr","symbol","attr","attr"))
r2html
add_point(dat2[10100:10110],map(lon=long,lat=lat,fill="green",size=Scale))
r2html <- data.table(R=c("col","fill","stroke","size","group","lon","lat"),SVG=c("stroke","fill","stroke-width","scale","symbol","lon","lat"),Default=c("black","red",2,5,"circle",NA,NA),Call=c("style","style","style","attr","symbol","attr","attr"))
data <- dat2[1:10]
dim(data)
class(data)
mapping[r2html[! R %in% names(mapping),R]] <- r2html[! R %in% names(mapping),Default]
mapping <- mapping[match(r2html$R,names(mapping))]
names(mapping) <- r2html$SVG
mapping
dt <- data[,lapply(mapping,eval,envir=data)]
dt
d3js <- ".append('svg:circle').attr('cx', padding).attr('cy', padding).attr('r', function(d) {return d.value.scale;}).attr('stroke',function(d) {return d.value.stroke}).attr('stroke-width',function(d) {return d.value.stroke_width}).style('fill',function(d) {return d.value.fill}).on('click',expandNode).on('dblclick',null).on('mouseover',function(d){ console.log(d.key); })"
cat(d3js)
json <- paste("[",paste(apply(dt,1,toJSON),collapse=","),"]",sep="")
cat(json)
mapping <- map(lon=long,lat=lat,fill="green",size=Scale)
mapping[r2html[! R %in% names(mapping),R]] <- r2html[! R %in% names(mapping),Default]
mapping <- mapping[match(r2html$R,names(mapping))]
names(mapping) <- r2html$SVG
dt <- data[,lapply(mapping,eval,envir=data)]
json <- paste("[",paste(apply(dt,1,toJSON),collapse=","),"]",sep="")
cat(json)
paste(apply(dt,1,toJSON),collapse=",")
apply(dt,1,toJSON)
apply
dt
sapply(dt,class)
dt[1]
as.character(lv)
dt[1]
toJSON(lv)
sapply(1:nrow(dt),toJSON(dt[i]))
sapply(1:nrow(dt),function(i) toJSON(dt[i]))
cat(paste("[",paste(sapply(1:nrow(dt),toJSON(dt[i])),collapse=","),"]",sep=""))
cat(paste("[",paste(sapply(1:nrow(dt),function(i) toJSON(dt[i])),collapse=","),"]",sep=""))
source("r:/users/cmcneil/projects/miscellaneous/personal/d3/googleMaps.R")
add_point(dat2[10100:10110],map(lon=long,lat=lat,fill="green",size=Scale,stroke=Stroke,col="red"))
dat2$Stroke <- (1:5)*2
add_point(dat2[10100:10110],map(lon=long,lat=lat,fill="green",size=Scale,stroke=Stroke,col="red"))
